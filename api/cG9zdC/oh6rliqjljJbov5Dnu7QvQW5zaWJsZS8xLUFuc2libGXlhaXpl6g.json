{"title":"1-Ansible入门","date":"2020-02-06T08:21:31.000Z","date_formatted":{"ll":"Feb 6, 2020","L":"02/06/2020","MM-DD":"02-06"},"thumbnail":"post/自动化运维/Ansible/1-Ansible入门/cover.png","link":"post/自动化运维/Ansible/1-Ansible入门","categories":["Ansible","自动化运维"],"updated":"2020-02-08T02:53:40.519Z","content":"<h1 id=\"环境准备\">环境准备<a href=\"#环境准备\" title=\"环境准备\"></a></h1><h2 id=\"主控端\">主控端<a href=\"#主控端\" title=\"主控端\"></a></h2><p>主控端只能是<code>Linux</code>主机，我们准备了一个<code>CentOS7</code>的虚拟机，配置<code>IP</code>地址为<code>192.168.31.200</code></p>\n<h2 id=\"被控端\">被控端<a href=\"#被控端\" title=\"被控端\"></a></h2><ul><li><p><code>node01</code></p>\n<ul><li><code>OS</code>: <code>CentOS7</code></li>\n<li><code>IP</code>: <code>192.168.31.101</code></li>\n</ul></li>\n<li><p><code>node02</code></p>\n<ul><li><code>OS</code>: <code>CentOS7</code></li>\n<li><code>IP</code>: <code>192.168.31.102</code></li>\n</ul></li>\n</ul><h2 id=\"配置无密ssh登录\">配置无密SSH登录<a href=\"#配置无密ssh登录\" title=\"配置无密SSH登录\"></a></h2><p>在主控端执行：</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-key-gen</span><br><span class=\"line\"></span><br><span class=\"line\">ssh-copy-id root@192.168.31.101</span><br><span class=\"line\">ssh-copy-id root@192.168.31.102</span><br></pre></td></tr></table></figure>\n\n\n<h1 id=\"ansible安装\">Ansible安装<a href=\"#ansible安装\" title=\"Ansible安装\"></a></h1><p><code>Ansible</code>属于<code>Agentless</code>，采用<code>SSH</code>协议进行工作，无需在被控端主机上安装任何软件，只要支持<code>SSH</code>协议即可，在主控端我们需要安装<code>Ansible</code>。</p>\n<h2 id=\"安装\">安装<a href=\"#安装\" title=\"安装\"></a></h2><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip3 install ansible</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"配置\">配置<a href=\"#配置\" title=\"配置\"></a></h2><p><strong>ansible.cfg</strong>\n下载<code>https://github.com/ansible/ansible/tree/devel/examples</code>下的<code>ansible.cfg</code>放到<code>/etc/ansible</code>目录下。</p>\n<ul><li><code>inventory</code>主机列表配置文件</li>\n<li><code>library</code>库文件位置</li>\n<li><code>remote_tmp</code>执行操作时被控端暂存文件目录</li>\n<li><code>local_tmp</code>执行操作时主控端暂存文件目录</li>\n<li><code>forks</code>执行操作时的并发数</li>\n<li><code>ask_pass</code>是否每次执行都询问SSH密码</li>\n<li><code>remote_user</code>远程登录的用户</li>\n<li><code>log_path</code>日志文件路径</li>\n<li><code>sudo_user</code>默认sudo用户</li>\n<li><code>remote_port</code>主机端口号</li>\n<li><code>host_key_checking</code>是否每次执行都检查key</li>\n<li><code>pipeling</code>是否打开<code>SSH Pipeling</code>，可大幅提高性能</li>\n</ul><p><strong>hosts</strong>\n在<code>/etc/ansible</code>目录下新建<code>hosts</code>文件。</p>\n<h1 id=\"ansible入门\">Ansible入门<a href=\"#ansible入门\" title=\"Ansible入门\"></a></h1><h2 id=\"配置inventory\">配置Inventory<a href=\"#配置inventory\" title=\"配置Inventory\"></a></h2><p>将两台被控机加入到<code>/etc/ansible/hosts</code>中</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[mq]</span><br><span class=\"line\">192.168.31.10[1:2]</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"测试\">测试<a href=\"#测试\" title=\"测试\"></a></h2><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ansible mq -m ping</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4/Ansible/1-Ansible%E5%85%A5%E9%97%A8/1.png\" class=\"\">","prev":{"title":"2-Ansible模块","link":"post/自动化运维/Ansible/2-Ansible模块"},"next":{"title":"8-shiro集成Spring","link":"post/Java/Shiro/8-shiro集成Spring"},"plink":"https://beginc.github.io/post/自动化运维/Ansible/1-Ansible入门/","toc":[{"id":"环境准备","title":"环境准备","index":"1","children":[{"id":"主控端","title":"主控端","index":"1.1"},{"id":"被控端","title":"被控端","index":"1.2"},{"id":"配置无密ssh登录","title":"配置无密SSH登录","index":"1.3"}]},{"id":"ansible安装","title":"Ansible安装","index":"2","children":[{"id":"安装","title":"安装","index":"2.1"},{"id":"配置","title":"配置","index":"2.2"}]},{"id":"ansible入门","title":"Ansible入门","index":"3","children":[{"id":"配置inventory","title":"配置Inventory","index":"3.1"},{"id":"测试","title":"测试","index":"3.2"}]}]}