{"title":"Redis之常见解决方案","date":"2020-03-02T07:57:10.000Z","date_formatted":{"ll":"Mar 2, 2020","L":"03/02/2020","MM-DD":"03-02"},"thumbnail":"post/中间件/Redis/Redis之常见解决方案/cover.png","link":"post/中间件/Redis/Redis之常见解决方案","categories":["Redis","中间件"],"updated":"2020-03-02T10:27:27.330Z","content":"<h1 id=\"缓存预热\">缓存预热<a href=\"#缓存预热\" title=\"缓存预热\"></a></h1><p>启动redis服务器时主动加载一些数据，减缓启动服务器时数据库的压力。</p>\n<p><strong>解决方法</strong></p>\n<ul><li>根据统计结果加载热点数据</li>\n</ul><h1 id=\"缓存雪崩\">缓存雪崩<a href=\"#缓存雪崩\" title=\"缓存雪崩\"></a></h1><h2 id=\"问题\">问题<a href=\"#问题\" title=\"问题\"></a></h2><p>在一个较短的时间内，缓存中较多的key集中过期，导致数据库被请求压垮。</p>\n<h2 id=\"解决\">解决<a href=\"#解决\" title=\"解决\"></a></h2><ul><li>多级缓存 Nginx缓存 + Redis缓存 + Ehcache缓存</li>\n<li>服务限流降级</li>\n<li>使用LRU缓存策略保留热点数据</li>\n<li>过期时间使用固定时间 + 随机值</li>\n<li>热点数据延时</li>\n</ul><h1 id=\"缓存击穿\">缓存击穿<a href=\"#缓存击穿\" title=\"缓存击穿\"></a></h1><h2 id=\"问题-1\">问题<a href=\"#问题-1\" title=\"问题\"></a></h2><p>单个热点数据过期的瞬间，大量请求压垮了数据库服务器。</p>\n<h2 id=\"解决-1\">解决<a href=\"#解决-1\" title=\"解决\"></a></h2><p>和缓存雪崩类似</p>\n<h1 id=\"缓存穿透\">缓存穿透<a href=\"#缓存穿透\" title=\"缓存穿透\"></a></h1><h2 id=\"问题-2\">问题<a href=\"#问题-2\" title=\"问题\"></a></h2><p>用户请求了不存在的数据，导致Redis缓存不命中，流量压往数据库，<strong>大量该种请求则可能是黑客攻击。</strong></p>\n<h2 id=\"解决-2\">解决<a href=\"#解决-2\" title=\"解决\"></a></h2><ul><li>缓存null结果，设置短过期时间</li>\n<li>白名单策略<ul><li>将数据id使用bitmap存储，不在其中的key请求注解拦截</li>\n</ul></li>\n<li>key加密<ul><li>将key进行加密，发现不符合规则的key后直接拦截</li>\n</ul></li>\n</ul>","prev":{"title":"Redis之数据删除策略","link":"post/中间件/Redis/Redis之数据删除策略"},"next":{"title":"Redis之哨兵模式","link":"post/中间件/Redis/Redis之哨兵模式"},"plink":"https://beginc.github.io/post/中间件/Redis/Redis之常见解决方案/","toc":[{"id":"缓存预热","title":"缓存预热","index":"1"},{"id":"缓存雪崩","title":"缓存雪崩","index":"2","children":[{"id":"问题","title":"问题","index":"2.1"},{"id":"解决","title":"解决","index":"2.2"}]},{"id":"缓存击穿","title":"缓存击穿","index":"3","children":[{"id":"问题-1","title":"问题","index":"3.1"},{"id":"解决-1","title":"解决","index":"3.2"}]},{"id":"缓存穿透","title":"缓存穿透","index":"4","children":[{"id":"问题-2","title":"问题","index":"4.1"},{"id":"解决-2","title":"解决","index":"4.2"}]}]}