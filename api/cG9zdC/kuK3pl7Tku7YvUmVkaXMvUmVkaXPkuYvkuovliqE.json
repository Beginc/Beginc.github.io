{"title":"Redis之事务","date":"2020-03-01T08:28:41.000Z","date_formatted":{"ll":"Mar 1, 2020","L":"03/01/2020","MM-DD":"03-01"},"thumbnail":"post/中间件/Redis/Redis之事务/cover.png","link":"post/中间件/Redis/Redis之事务","categories":["Redis","中间件"],"updated":"2020-03-02T10:25:13.146Z","content":"<h1 id=\"redis事务特征\">Redis事务特征<a href=\"#redis事务特征\" title=\"Redis事务特征\"></a></h1><ul><li><p>原子性：事务内的一组命令会按顺序原子性执行，不会被其他指令插入</p>\n</li>\n<li><p>执行失败无法回滚</p>\n</li>\n</ul><h1 id=\"redis事务命令\">Redis事务命令<a href=\"#redis事务命令\" title=\"Redis事务命令\"></a></h1><p><strong>MULTI</strong></p>\n<p>开启事务，之后的所有命令都会被放入队列缓存。</p>\n<p><strong>EXEC</strong></p>\n<p>执行事务，事务内所有命令被按顺序原子执行。</p>\n<p><strong>DISCARD</strong></p>\n<p>没有EXEC之前，使用DISCARD撤销事务，队列内命令被删除。</p>\n<p><strong>WATCH</strong></p>\n<p>事务开始前，监视某些key，若EXEC时发现key被改变了，则撤销事务。</p>\n<p><strong>UNWATCH</strong></p>\n<p>撤销监视。</p>\n<p><strong>实例</strong></p>\n<ul><li>提交事务</li>\n</ul><img src=\"/post/%E4%B8%AD%E9%97%B4%E4%BB%B6/Redis/Redis%E4%B9%8B%E4%BA%8B%E5%8A%A1/image-20200301223650487.png\" class=\"\">\n\n<ul><li>放弃事务</li>\n</ul><img src=\"/post/%E4%B8%AD%E9%97%B4%E4%BB%B6/Redis/Redis%E4%B9%8B%E4%BA%8B%E5%8A%A1/image-20200301223746783.png\" class=\"\">\n\n<h1 id=\"redis事务错误处理\">Redis事务错误处理<a href=\"#redis事务错误处理\" title=\"Redis事务错误处理\"></a></h1><p><strong>命令写错</strong></p>\n<p>事务直接被取消。</p>\n<img src=\"/post/%E4%B8%AD%E9%97%B4%E4%BB%B6/Redis/Redis%E4%B9%8B%E4%BA%8B%E5%8A%A1/image-20200301223909101.png\" class=\"\">\n\n<p><strong>命令执行出错</strong></p>\n<p>其他命令依然会被执行，不会回滚事务。</p>\n","prev":{"title":"Redis之发布订阅","link":"post/中间件/Redis/Redis之发布订阅"},"next":{"title":"Redis之HyperLogLog","link":"post/中间件/Redis/Redis之HyperLogLog"},"plink":"https://beginc.github.io/post/中间件/Redis/Redis之事务/","toc":[{"id":"redis事务特征","title":"Redis事务特征","index":"1"},{"id":"redis事务命令","title":"Redis事务命令","index":"2"},{"id":"redis事务错误处理","title":"Redis事务错误处理","index":"3"}]}