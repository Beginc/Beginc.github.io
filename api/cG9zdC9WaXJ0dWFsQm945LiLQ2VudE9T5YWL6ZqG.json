{"title":"VirtualBox下CentOS克隆","date":"2019-09-09T14:44:38.000Z","thumbnail":"/post/VirtualBox下CentOS克隆/cover.jpg","link":"post/VirtualBox下CentOS克隆","tags":["虚拟机"],"categories":["Linux"],"updated":"2019-09-11T14:48:04.790Z","content":"<h1 id=\"CentOS-Minimal安装配置\">CentOS-Minimal安装配置<a href=\"post/VirtualBox下CentOS克隆#CentOS-Minimal安装配置\"></a></h1><p>先用<code>Minimal</code>镜像安装好一台虚拟机，进行配置。</p>\n<h2 id=\"安装wget\">安装wget<a href=\"post/VirtualBox下CentOS克隆#安装wget\"></a></h2><figure class=\"highlight bash\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install wget</span><br></pre></td></tr></table></div></figure>\n\n<h2 id=\"源配置\">源配置<a href=\"post/VirtualBox下CentOS克隆#源配置\"></a></h2><p>详见<a href=\"/post/各种源配置/\" title=\"各种源配置\">各种源配置</a></p>\n<h2 id=\"安装ifconfig\">安装ifconfig<a href=\"post/VirtualBox下CentOS克隆#安装ifconfig\"></a></h2><figure class=\"highlight bash\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install net-tools</span><br></pre></td></tr></table></div></figure>\n\n<h2 id=\"桥接网络设置\">桥接网络设置<a href=\"post/VirtualBox下CentOS克隆#桥接网络设置\"></a></h2><p>详见<a href=\"/post/CentOS网络配置/\" title=\"CentOS网络配置\">CentOS网络配置</a></p>\n<h2 id=\"设置开机菜单选择时间\">设置开机菜单选择时间<a href=\"post/VirtualBox下CentOS克隆#设置开机菜单选择时间\"></a></h2><p>缩短选择时间，快速开机。</p>\n<p><strong>CentOS7</strong></p>\n<figure class=\"highlight bash\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo vi /etc/grub2.cfg</span><br></pre></td></tr></table></div></figure>\n\n<img src=\"/post/VirtualBox下CentOS克隆/5.png\" class=\"article-img\">\n\n\n<h1 id=\"CentOS克隆准备\">CentOS克隆准备<a href=\"post/VirtualBox下CentOS克隆#CentOS克隆准备\"></a></h1><p>由于克隆后两台虚拟机会有相同的MAC地址，发生冲突，需要提前先进行一些配置。</p>\n<ol>\n<li>删除MAC和UUID</li>\n</ol>\n<figure class=\"highlight bash\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo vi /etc/sysconfig/network-scripts/ifcfg-enp0s3</span><br></pre></td></tr></table></div></figure>\n\n<p>将<code>HWADDR</code>和<code>UUID</code>注释掉，解除其与网卡名称的绑定。</p>\n<ol start=\"2\">\n<li>删除文件<br>该文件将网卡名和MAC地址进行了绑定，克隆后的虚拟机会使用新的MAC地址，将会出错。</li>\n</ol>\n<figure class=\"highlight bash\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo rm /etc/udev/rules.d/70-persistent-ipoib.rules</span><br></pre></td></tr></table></div></figure>\n\n<ol start=\"3\">\n<li>重启网络服务</li>\n</ol>\n<figure class=\"highlight bash\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service network restart</span><br></pre></td></tr></table></div></figure>\n\n<h1 id=\"生成快照\">生成快照<a href=\"post/VirtualBox下CentOS克隆#生成快照\"></a></h1><p>安装完后，在<code>VirtualBox</code>中生成快照，之后可用于克隆。</p>\n<img src=\"/post/VirtualBox下CentOS克隆/1.png\" class=\"article-img\">\n\n<img src=\"/post/VirtualBox下CentOS克隆/2.png\" class=\"article-img\">\n\n<h1 id=\"克隆虚拟机\">克隆虚拟机<a href=\"post/VirtualBox下CentOS克隆#克隆虚拟机\"></a></h1><img src=\"/post/VirtualBox下CentOS克隆/3.png\" class=\"article-img\">\n\n<h1 id=\"更新克隆机的MAC地址\">更新克隆机的MAC地址<a href=\"post/VirtualBox下CentOS克隆#更新克隆机的MAC地址\"></a></h1><img src=\"/post/VirtualBox下CentOS克隆/4.png\" class=\"article-img\">\n\n<h1 id=\"修改静态IP\">修改静态IP<a href=\"post/VirtualBox下CentOS克隆#修改静态IP\"></a></h1><p>克隆后的虚拟机和其父本有一样的IP，需要修改。</p>\n<figure class=\"highlight bash\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 打开后对IPADDR进行更改</span></span><br><span class=\"line\">sudo vi /etc/sysconfig/network-scripts/ifcfg-enp0s3</span><br></pre></td></tr></table></div></figure>\n\n<h1 id=\"主机名修改\">主机名修改<a href=\"post/VirtualBox下CentOS克隆#主机名修改\"></a></h1><p>这一步不是必要的。</p>\n<p><strong>CentOS7</strong></p>\n<figure class=\"highlight bash\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo vi /etc/hostname</span><br></pre></td></tr></table></div></figure>\n\n<p>设置<code>hostname</code>,重启生效。</p>\n<figure class=\"highlight bash\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node01</span><br></pre></td></tr></table></div></figure>\n\n<p><strong>CentOS6</strong></p>\n<figure class=\"highlight bash\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo vi /etc/sysconfig/network</span><br></pre></td></tr></table></div></figure>\n\n<p>设置<code>hostname</code>,重启生效。</p>\n<figure class=\"highlight bash\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">HOSTNAME=node01</span><br></pre></td></tr></table></div></figure>\n\n<p><strong>设置hostname映射</strong><br>将<code>hostname</code>映射到<code>IP</code></p>\n<figure class=\"highlight bash\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo vi /etc/hosts</span><br></pre></td></tr></table></div></figure>\n\n<p>设置映射</p>\n<figure class=\"highlight bash\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 本机可以不设置</span></span><br><span class=\"line\">192.168.1.101 node01</span><br><span class=\"line\"><span class=\"comment\"># 设置别的机器的映射</span></span><br><span class=\"line\">192.168.1.102 node02</span><br></pre></td></tr></table></div></figure>","prev":{"title":"MIPS-Like单周期16位CPU设计","link":"post/MIPS-Like单周期CPU设计"},"next":{"title":"各种源配置","link":"post/各种源配置"},"plink":"https://beginc.github.io/post/VirtualBox下CentOS克隆/","toc":[{"title":"CentOS-Minimal安装配置","id":"CentOS-Minimal安装配置","index":"1","children":[{"title":"安装wget","id":"安装wget","index":"1.1"},{"title":"源配置","id":"源配置","index":"1.2"},{"title":"安装ifconfig","id":"安装ifconfig","index":"1.3"},{"title":"桥接网络设置","id":"桥接网络设置","index":"1.4"},{"title":"设置开机菜单选择时间","id":"设置开机菜单选择时间","index":"1.5"}]},{"title":"CentOS克隆准备","id":"CentOS克隆准备","index":"2"},{"title":"生成快照","id":"生成快照","index":"3"},{"title":"克隆虚拟机","id":"克隆虚拟机","index":"4"},{"title":"更新克隆机的MAC地址","id":"更新克隆机的MAC地址","index":"5"},{"title":"修改静态IP","id":"修改静态IP","index":"6"},{"title":"主机名修改","id":"主机名修改","index":"7"}]}