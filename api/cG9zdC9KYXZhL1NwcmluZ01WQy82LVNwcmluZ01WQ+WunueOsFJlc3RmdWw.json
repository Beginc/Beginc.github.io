{"title":"6-SpringMVC实现Restful","date":"2020-02-05T11:21:52.000Z","date_formatted":{"ll":"Feb 5, 2020","L":"02/05/2020","MM-DD":"02-05"},"thumbnail":"post/Java/SpringMVC/6-SpringMVC实现Restful/cover.png","link":"post/Java/SpringMVC/6-SpringMVC实现Restful","categories":["Java","SpringMVC"],"updated":"2020-02-08T02:43:29.595Z","content":"<h1 id=\"依赖\">依赖<a href=\"#依赖\" title=\"依赖\"></a></h1><p>要将<code>JSON</code>字符串和<code>pojo</code>对象互相转化必须引入<code>jackson-databind</code>包。</p>\n<h1 id=\"方式一：controller--requestmapping--requestbody--responsebody\">方式一：@Controller + @RequestMapping + @RequestBody + @ResponseBody<a href=\"#方式一：controller--requestmapping--requestbody--responsebody\" title=\"方式一：@Controller + @RequestMapping + @RequestBody + @ResponseBody\"></a></h1><h2 id=\"编写pojo类\">编写pojo类<a href=\"#编写pojo类\" title=\"编写pojo类\"></a></h2><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer id;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;String&gt; hobbies;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">User</span><span class=\"params\">(Integer id, String name, List&lt;String&gt; hobbies)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.id = id;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.hobbies = hobbies;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">User</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">toString</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"User&#123;\"</span> +</span><br><span class=\"line\">                <span class=\"string\">\"id=\"</span> + id +</span><br><span class=\"line\">                <span class=\"string\">\", name='\"</span> + name + <span class=\"string\">'\\''</span> +</span><br><span class=\"line\">                <span class=\"string\">\", hobbies=\"</span> + hobbies +</span><br><span class=\"line\">                <span class=\"string\">'&#125;'</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Integer <span class=\"title\">getId</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> id;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setId</span><span class=\"params\">(Integer id)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.id = id;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getName</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setName</span><span class=\"params\">(String name)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> List&lt;String&gt; <span class=\"title\">getHobbies</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> hobbies;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setHobbies</span><span class=\"params\">(List&lt;String&gt; hobbies)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.hobbies = hobbies;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"restful-api设计\">Restful API设计<a href=\"#restful-api设计\" title=\"Restful API设计\"></a></h2><ul><li><code>GET /users/</code>查找所有用户</li>\n<li><code>GET /users/1/</code>查找<code>id</code>为1的用户</li>\n<li><code>POST /users/</code>添加用户</li>\n<li><code>DELETE /users/</code>删除所有用户</li>\n<li><code>DELETE /users/1/</code>删除<code>id</code>为1的用户</li>\n<li><code>PUT /users/1/</code>更新<code>id</code>为1的用户</li>\n</ul><h2 id=\"编写controller类\">编写Controller类<a href=\"#编写controller类\" title=\"编写Controller类\"></a></h2><ul><li><code>@RequestMethod</code>指定请求方法（下列<code>DELETE</code>方法和<code>PUT</code>方法会返回403错误，稍后解决）</li>\n<li><code>@RequestBody</code>解析<code>JSON</code>参数转化成对象</li>\n<li><code>@ResponseBody</code>将返回值转化成<code>JSON</code></li>\n</ul><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Controller</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PlainController</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping</span>(path=<span class=\"string\">\"/users/\"</span>, method = RequestMethod.GET)</span><br><span class=\"line\">    <span class=\"meta\">@ResponseBody</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> List&lt;User&gt; <span class=\"title\">findAll</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        List&lt;User&gt; users = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++) &#123;</span><br><span class=\"line\">            User user = <span class=\"keyword\">new</span> User();</span><br><span class=\"line\">            List&lt;String&gt; hobbies = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">            hobbies.add(<span class=\"string\">\"打球\"</span>);</span><br><span class=\"line\">            hobbies.add(<span class=\"string\">\"吃火锅\"</span>);</span><br><span class=\"line\">            user.setHobbies(hobbies);</span><br><span class=\"line\">            user.setId(i);</span><br><span class=\"line\">            user.setName(<span class=\"string\">\"罗浩文\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            users.add(user);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> users;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping</span>(path = <span class=\"string\">\"/users/&#123;id&#125;/\"</span>, method = RequestMethod.GET)</span><br><span class=\"line\">    <span class=\"meta\">@ResponseBody</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> User <span class=\"title\">findById</span><span class=\"params\">(@PathVariable(name = <span class=\"string\">\"id\"</span>, required = <span class=\"keyword\">true</span>)</span> <span class=\"keyword\">int</span> id)</span>&#123;</span><br><span class=\"line\">        User user = <span class=\"keyword\">new</span> User();</span><br><span class=\"line\">        List&lt;String&gt; hobbies = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">        hobbies.add(<span class=\"string\">\"打球\"</span>);</span><br><span class=\"line\">        hobbies.add(<span class=\"string\">\"吃火锅\"</span>);</span><br><span class=\"line\">        user.setHobbies(hobbies);</span><br><span class=\"line\">        user.setId(id);</span><br><span class=\"line\">        user.setName(<span class=\"string\">\"罗浩文\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping</span>(path = <span class=\"string\">\"/users/\"</span>, method = RequestMethod.POST)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(@RequestBody User user)</span></span>&#123;</span><br><span class=\"line\">        System.out.println(user);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 返回403 Forbidden</span></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping</span>(path = <span class=\"string\">\"/users/\"</span>, method = RequestMethod.DELETE)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">deleteAll</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"delete all\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 返回403 Forbidden</span></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping</span>(path = <span class=\"string\">\"/users/&#123;id&#125;/\"</span>, method = RequestMethod.DELETE)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">deleteById</span><span class=\"params\">(@PathVariable(name = <span class=\"string\">\"id\"</span>, required = <span class=\"keyword\">true</span>)</span> <span class=\"keyword\">int</span> id)</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"delete user \"</span> + id);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 返回403 Forbidden</span></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping</span>(path = <span class=\"string\">\"/users/&#123;id&#125;/\"</span>, method = RequestMethod.PUT)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">updateById</span><span class=\"params\">(@PathVariable(name = <span class=\"string\">\"id\"</span>, required = <span class=\"keyword\">true</span>)</span> <span class=\"keyword\">int</span> id, @RequestBody User user)</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"update user \"</span> + id + <span class=\"string\">\"  \"</span> + user);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"状态码\">状态码<a href=\"#状态码\" title=\"状态码\"></a></h2><p>在请求成功和出错时应该返回适当的状态码。</p>\n<ul><li><code>@ResponseStatus</code>指定状态码</li>\n</ul><h3 id=\"请求成功\">请求成功<a href=\"#请求成功\" title=\"请求成功\"></a></h3><p><code>Controller</code>方法上使用<code>@ResponseStatus</code>可指定请求成功时返回的状态码。</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Controller</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PlainController</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping</span>(path=<span class=\"string\">\"/users/\"</span>, method = RequestMethod.GET)</span><br><span class=\"line\">    <span class=\"meta\">@ResponseBody</span></span><br><span class=\"line\">    <span class=\"meta\">@ResponseStatus</span>(HttpStatus.OK)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> List&lt;User&gt; <span class=\"title\">findAll</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        List&lt;User&gt; users = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++) &#123;</span><br><span class=\"line\">            User user = <span class=\"keyword\">new</span> User();</span><br><span class=\"line\">            List&lt;String&gt; hobbies = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">            hobbies.add(<span class=\"string\">\"打球\"</span>);</span><br><span class=\"line\">            hobbies.add(<span class=\"string\">\"吃火锅\"</span>);</span><br><span class=\"line\">            user.setHobbies(hobbies);</span><br><span class=\"line\">            user.setId(i);</span><br><span class=\"line\">            user.setName(<span class=\"string\">\"罗浩文\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            users.add(user);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> users;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping</span>(path = <span class=\"string\">\"/users/&#123;id&#125;/\"</span>, method = RequestMethod.GET)</span><br><span class=\"line\">    <span class=\"meta\">@ResponseBody</span></span><br><span class=\"line\">    <span class=\"meta\">@ResponseStatus</span>(HttpStatus.OK)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> User <span class=\"title\">findById</span><span class=\"params\">(@PathVariable(name = <span class=\"string\">\"id\"</span>, required = <span class=\"keyword\">true</span>)</span> <span class=\"keyword\">int</span> id)</span>&#123;</span><br><span class=\"line\">        User user = <span class=\"keyword\">new</span> User();</span><br><span class=\"line\">        List&lt;String&gt; hobbies = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">        hobbies.add(<span class=\"string\">\"打球\"</span>);</span><br><span class=\"line\">        hobbies.add(<span class=\"string\">\"吃火锅\"</span>);</span><br><span class=\"line\">        user.setHobbies(hobbies);</span><br><span class=\"line\">        user.setId(id);</span><br><span class=\"line\">        user.setName(<span class=\"string\">\"罗浩文\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping</span>(path = <span class=\"string\">\"/users/\"</span>, method = RequestMethod.POST)</span><br><span class=\"line\">    <span class=\"meta\">@ResponseStatus</span>(HttpStatus.OK)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(@RequestBody User user)</span></span>&#123;</span><br><span class=\"line\">        System.out.println(user);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping</span>(path = <span class=\"string\">\"/users/\"</span>, method = RequestMethod.DELETE)</span><br><span class=\"line\">    <span class=\"meta\">@ResponseStatus</span>(HttpStatus.OK)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">deleteAll</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"delete all\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping</span>(path = <span class=\"string\">\"/users/&#123;id&#125;/\"</span>, method = RequestMethod.DELETE)</span><br><span class=\"line\">    <span class=\"meta\">@ResponseStatus</span>(HttpStatus.OK)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">deleteById</span><span class=\"params\">(@PathVariable(name = <span class=\"string\">\"id\"</span>, required = <span class=\"keyword\">true</span>)</span> <span class=\"keyword\">int</span> id)</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"delete user \"</span> + id);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping</span>(path = <span class=\"string\">\"/users/&#123;id&#125;/\"</span>, method = RequestMethod.PUT)</span><br><span class=\"line\">    <span class=\"meta\">@ResponseStatus</span>(HttpStatus.OK)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">updateById</span><span class=\"params\">(@PathVariable(name = <span class=\"string\">\"id\"</span>, required = <span class=\"keyword\">true</span>)</span> <span class=\"keyword\">int</span> id, @RequestBody User user)</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"update user \"</span> + id + <span class=\"string\">\"  \"</span> + user);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"请求失败\">请求失败<a href=\"#请求失败\" title=\"请求失败\"></a></h3><h4 id=\"方式一：自定义异常类指定状态码\">方式一：自定义异常类指定状态码<a href=\"#方式一：自定义异常类指定状态码\" title=\"方式一：自定义异常类指定状态码\"></a></h4><ul><li>抛出自定义异常类</li>\n<li>在自定义异常类上用<code>@ResponseStatus</code>指明异常时返回的状态码</li>\n</ul><p><strong>自定义异常</strong></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ResponseStatus</span>(HttpStatus.BAD_REQUEST)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CustomException</span> <span class=\"keyword\">extends</span> <span class=\"title\">RuntimeException</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">CustomException</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">CustomException</span><span class=\"params\">(String s)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>(s);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>Controller</strong></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Controller</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PlainController</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping</span>(path = <span class=\"string\">\"/error/\"</span>, method = RequestMethod.GET)</span><br><span class=\"line\">    <span class=\"meta\">@ResponseStatus</span>(HttpStatus.OK)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">error</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> CustomException(<span class=\"string\">\"custom exception\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"方式二：controlleradvice处理异常指定状态码\">方式二：@ControllerAdvice处理异常指定状态码<a href=\"#方式二：controlleradvice处理异常指定状态码\" title=\"方式二：@ControllerAdvice处理异常指定状态码\"></a></h4><p>使用<code>@ControllerAdvice</code>和<code>@ExceptionHandler</code>进行异常处理，并指定状态码。</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ControllerAdvice</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyControllerAdvice</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@ResponseStatus</span>(HttpStatus.BAD_REQUEST)</span><br><span class=\"line\">    <span class=\"meta\">@ExceptionHandler</span>(CustomException<span class=\"class\">.<span class=\"keyword\">class</span>)</span></span><br><span class=\"line\"><span class=\"class\">    <span class=\"title\">public</span> <span class=\"title\">void</span> <span class=\"title\">handleCustomException</span>(<span class=\"title\">CustomException</span> <span class=\"title\">e</span>)</span>&#123;</span><br><span class=\"line\">        System.out.println(e.getMessage());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"方式二：restcontroller--xxxmapping--requestbody\">方式二：@RestController + @XXXMapping + @RequestBody<a href=\"#方式二：restcontroller--xxxmapping--requestbody\" title=\"方式二：@RestController + @XXXMapping + @RequestBody\"></a></h1><ul><li><code>@RestController</code>的所有方法都使用<code>@ResponseBody</code>返回<code>JSON</code></li>\n<li><code>XXXMapping</code><ul><li><code>GetMapping</code></li>\n<li><code>PostMapping</code></li>\n<li><code>PutMapping</code></li>\n<li><code>DeleteMapping</code></li>\n<li>...</li>\n</ul></li>\n</ul><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RestfulController</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping</span>(<span class=\"string\">\"/rest/users/\"</span>)</span><br><span class=\"line\">    <span class=\"meta\">@ResponseStatus</span>(HttpStatus.OK)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> List&lt;User&gt; <span class=\"title\">findAll</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        List&lt;User&gt; users = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++) &#123;</span><br><span class=\"line\">            User user = <span class=\"keyword\">new</span> User();</span><br><span class=\"line\">            List&lt;String&gt; hobbies = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">            hobbies.add(<span class=\"string\">\"打球\"</span>);</span><br><span class=\"line\">            hobbies.add(<span class=\"string\">\"吃火锅\"</span>);</span><br><span class=\"line\">            user.setHobbies(hobbies);</span><br><span class=\"line\">            user.setId(i);</span><br><span class=\"line\">            user.setName(<span class=\"string\">\"罗浩文\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            users.add(user);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> users;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping</span>(<span class=\"string\">\"/rest/users/&#123;id&#125;/\"</span>)</span><br><span class=\"line\">    <span class=\"meta\">@ResponseStatus</span>(HttpStatus.OK)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> User <span class=\"title\">findById</span><span class=\"params\">(@PathVariable(name = <span class=\"string\">\"id\"</span>, required = <span class=\"keyword\">true</span>)</span> <span class=\"keyword\">int</span> id) </span>&#123;</span><br><span class=\"line\">        User user = <span class=\"keyword\">new</span> User();</span><br><span class=\"line\">        List&lt;String&gt; hobbies = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">        hobbies.add(<span class=\"string\">\"打球\"</span>);</span><br><span class=\"line\">        hobbies.add(<span class=\"string\">\"吃火锅\"</span>);</span><br><span class=\"line\">        user.setHobbies(hobbies);</span><br><span class=\"line\">        user.setId(id);</span><br><span class=\"line\">        user.setName(<span class=\"string\">\"罗浩文\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping</span>(<span class=\"string\">\"/rest/users/\"</span>)</span><br><span class=\"line\">    <span class=\"meta\">@ResponseStatus</span>(HttpStatus.OK)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(@RequestBody User user)</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(user);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@DeleteMapping</span>(<span class=\"string\">\"/rest/users/\"</span>)</span><br><span class=\"line\">    <span class=\"meta\">@ResponseStatus</span>(HttpStatus.OK)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">deleteAll</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"delete all\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@DeleteMapping</span>(<span class=\"string\">\"/rest/users/&#123;id&#125;/\"</span>)</span><br><span class=\"line\">    <span class=\"meta\">@ResponseStatus</span>(HttpStatus.OK)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">deleteById</span><span class=\"params\">(@PathVariable(name = <span class=\"string\">\"id\"</span>, required = <span class=\"keyword\">true</span>)</span> <span class=\"keyword\">int</span> id) </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"delete user \"</span> + id);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PutMapping</span>(<span class=\"string\">\"/rest/users/&#123;id&#125;/\"</span>)</span><br><span class=\"line\">    <span class=\"meta\">@ResponseStatus</span>(HttpStatus.OK)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">updateById</span><span class=\"params\">(@PathVariable(name = <span class=\"string\">\"id\"</span>, required = <span class=\"keyword\">true</span>)</span> <span class=\"keyword\">int</span> id, @RequestBody User user) </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"update user \"</span> + id + <span class=\"string\">\"  \"</span> + user);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping</span>(<span class=\"string\">\"/rest/error\"</span>)</span><br><span class=\"line\">    <span class=\"meta\">@ResponseStatus</span>(HttpStatus.OK)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">error</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> CustomException(<span class=\"string\">\"custom exception\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","prev":{"title":"1-shiro入门","link":"post/Java/Shiro/1-shiro入门"},"next":{"title":"5-SpringMVC拦截器","link":"post/Java/SpringMVC/5-SpringMVC拦截器"},"plink":"https://beginc.github.io/post/Java/SpringMVC/6-SpringMVC实现Restful/","toc":[{"id":"依赖","title":"依赖","index":"1"},{"id":"方式一：controller--requestmapping--requestbody--responsebody","title":"方式一：@Controller + @RequestMapping + @RequestBody + @ResponseBody","index":"2","children":[{"id":"编写pojo类","title":"编写pojo类","index":"2.1"},{"id":"restful-api设计","title":"Restful API设计","index":"2.2"},{"id":"编写controller类","title":"编写Controller类","index":"2.3"},{"id":"状态码","title":"状态码","index":"2.4","children":[{"id":"请求成功","title":"请求成功","index":"2.4.1"},{"id":"请求失败","title":"请求失败","index":"2.4.2"}]}]},{"id":"方式二：restcontroller--xxxmapping--requestbody","title":"方式二：@RestController + @XXXMapping + @RequestBody","index":"3"}]}