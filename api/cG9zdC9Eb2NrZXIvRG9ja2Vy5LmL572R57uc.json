{"title":"Docker之网络","date":"2020-02-29T12:14:49.000Z","date_formatted":{"ll":"Feb 29, 2020","L":"02/29/2020","MM-DD":"02-29"},"thumbnail":"post/Docker/Docker之网络/cover.jpg","link":"post/Docker/Docker之网络","categories":["Docker"],"updated":"2020-02-29T16:08:42.030Z","content":"<h1 id=\"linux-network-namespace\">Linux Network Namespace<a href=\"#linux-network-namespace\" title=\"Linux Network Namespace\"></a></h1><p>在Docker中，容器之间以及容器和宿主之间的网络环境可进行隔离，实现的技术是Linux Network Namespace，即每个容器都有自己独立的Namespace。</p>\n<p><strong>宿主Namespace</strong></p>\n<img src=\"/post/Docker/Docker%E4%B9%8B%E7%BD%91%E7%BB%9C/image-20200229220400562.png\" class=\"\">\n\n<p><strong>容器Namespace</strong></p>\n<img src=\"/post/Docker/Docker%E4%B9%8B%E7%BD%91%E7%BB%9C/image-20200229221748691.png\" class=\"\">\n\n<h2 id=\"veth\">Veth<a href=\"#veth\" title=\"Veth\"></a></h2><p>不同的Network Namespace之前要通信的话可以通过Linux提供的一种虚拟网络设备Veth来进行连接，Veth总是成对出现</p>\n<ul><li>输入端</li>\n<li>输出端</li>\n</ul><img src=\"/post/Docker/Docker%E4%B9%8B%E7%BD%91%E7%BB%9C/image-20200229222734492.png\" class=\"\">\n\n<h1 id=\"网桥\">网桥<a href=\"#网桥\" title=\"网桥\"></a></h1><p>网桥是工作在链路层的一种网络设备，它根据mac地址将帧转发到不同的出口，它可以隔离冲突域，连接不同的网段。</p>\n<img src=\"/post/Docker/Docker%E4%B9%8B%E7%BD%91%E7%BB%9C/image-20200229222245702.png\" class=\"\">\n\n<h2 id=\"docker0\">Docker0<a href=\"#docker0\" title=\"Docker0\"></a></h2><p>装好Docker后，宿主机上会有一个虚拟的网桥Docker0。</p>\n<img src=\"/post/Docker/Docker%E4%B9%8B%E7%BD%91%E7%BB%9C/image-20200229222815190.png\" class=\"\">\n\n<p>默认情况下各个容器都会通过Veth连接到Docker0，因此不同容器之间，以及容器和宿主机之间都是可以通信的。</p>\n<img src=\"/post/Docker/Docker%E4%B9%8B%E7%BD%91%E7%BB%9C/image-20200229222944834.png\" class=\"\">\n\n\n\n<h1 id=\"docker网络类型\">Docker网络类型<a href=\"#docker网络类型\" title=\"Docker网络类型\"></a></h1><h2 id=\"bridge\">Bridge<a href=\"#bridge\" title=\"Bridge\"></a></h2><p>就是使用网桥以及Veth来连接不同的container。</p>\n<h2 id=\"host\">Host<a href=\"#host\" title=\"Host\"></a></h2><p>容器和宿主机共享Network Namespace。</p>\n<h2 id=\"none\">None<a href=\"#none\" title=\"None\"></a></h2><p>容器内无网络接口，为孤立的Network Namespace。</p>\n<h2 id=\"container\">Container<a href=\"#container\" title=\"Container\"></a></h2><p>容器和另外一个容器共享Network Namespace。</p>\n<h1 id=\"docker网络常用命令\">Docker网络常用命令<a href=\"#docker网络常用命令\" title=\"Docker网络常用命令\"></a></h1><p><strong>查看网络</strong></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker network ls</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/Docker/Docker%E4%B9%8B%E7%BD%91%E7%BB%9C/image-20200229223722614.png\" class=\"\">\n\n<p><strong>查看网络详细信息</strong></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker network inspect 网络名称</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/Docker/Docker%E4%B9%8B%E7%BD%91%E7%BB%9C/image-20200229223818504.png\" class=\"\">\n\n<p><strong>创建网络</strong></p>\n<ul><li>-d：指定网络类型</li>\n</ul><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker network create -d 网络类型 网络名称</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/Docker/Docker%E4%B9%8B%E7%BD%91%E7%BB%9C/image-20200229223938090.png\" class=\"\">\n\n<p><strong>删除网络</strong></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker network rm 网络名称</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/Docker/Docker%E4%B9%8B%E7%BD%91%E7%BB%9C/image-20200229224048202.png\" class=\"\">\n\n<p><strong>连接网络</strong></p>\n<p>让容器连接到指定网络</p>\n<ul><li>启动时手动指定</li>\n</ul><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --network mybridge -d redis:5.0.7</span><br></pre></td></tr></table></figure>\n\n<ul><li>加入网络</li>\n</ul><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker network connect bridge 6ccee</span><br></pre></td></tr></table></figure>\n\n<p><strong>断开网络</strong></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker network disconnect bridge 6ccee</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/Docker/Docker%E4%B9%8B%E7%BD%91%E7%BB%9C/image-20200229224348861.png\" class=\"\">","prev":{"title":"Docker之数据持久化","link":"post/Docker/Docker之数据持久化"},"next":{"title":"Docker之镜像","link":"post/Docker/Docker之镜像"},"plink":"https://beginc.github.io/post/Docker/Docker之网络/","toc":[{"id":"linux-network-namespace","title":"Linux Network Namespace","index":"1","children":[{"id":"veth","title":"Veth","index":"1.1"}]},{"id":"网桥","title":"网桥","index":"2","children":[{"id":"docker0","title":"Docker0","index":"2.1"}]},{"id":"docker网络类型","title":"Docker网络类型","index":"3","children":[{"id":"bridge","title":"Bridge","index":"3.1"},{"id":"host","title":"Host","index":"3.2"},{"id":"none","title":"None","index":"3.3"},{"id":"container","title":"Container","index":"3.4"}]},{"id":"docker网络常用命令","title":"Docker网络常用命令","index":"4"}]}